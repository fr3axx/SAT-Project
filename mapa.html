<!DOCTYPE html>
<html>
<head>
    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css"/>
    <!-- small inline SVG favicon to avoid browser requesting /favicon.ico and showing 404 in console -->
    <link rel="icon" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><circle cx='8' cy='8' r='8' fill='%23007bff'/></svg>">
    
            <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
            <style>
                #map_8a7b0f5a23f28d54d3c5eaf7cecbeca0 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>

            <style>html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            </style>

            <style>#map {
                position:absolute;
                top:0;
                bottom:0;
                right:0;
                left:0;
                }
            </style>

            <script>
                L_NO_TOUCH = false;
                L_DISABLE_3D = false;
            </script>

        
</head>
<body>
    
    
            <div class="folium-map" id="map_8a7b0f5a23f28d54d3c5eaf7cecbeca0" ></div>
        
</body>
<script>
    
    
            var map_8a7b0f5a23f28d54d3c5eaf7cecbeca0 = L.map(
                "map_8a7b0f5a23f28d54d3c5eaf7cecbeca0",
                {
                    center: [20.0, 0.0],
                    crs: L.CRS.EPSG3857,
                    ...{
  "zoom": 2,
  "zoomControl": true,
  "preferCanvas": false,
}

                }
            );

            

        
    
            var tile_layer_292f1729a0d8579eae67581d0e343ad0 = L.tileLayer(
                "https://tile.openstreetmap.org/{z}/{x}/{y}.png",
                {
  "minZoom": 0,
  "maxZoom": 19,
  "maxNativeZoom": 19,
  "noWrap": false,
  "attribution": "\u0026copy; \u003ca href=\"https://www.openstreetmap.org/copyright\"\u003eOpenStreetMap\u003c/a\u003e contributors",
  "subdomains": "abc",
  "detectRetina": false,
  "tms": false,
  "opacity": 1,
}

            );
        
    
            tile_layer_292f1729a0d8579eae67581d0e343ad0.addTo(map_8a7b0f5a23f28d54d3c5eaf7cecbeca0);
        
    
            var marker_76b8cbc324890493435d5ebdbad292f2 = L.marker(
                [10.4806, -66.9036],
                {
}
            ).addTo(map_8a7b0f5a23f28d54d3c5eaf7cecbeca0);
        
    
        var popup_fe13833b4a88d9a4d5afc848a0d1db6b = L.popup({
  "maxWidth": "100%",
});

        
            
                var html_d646beacf37742d46d5311f63448bc5a = $(`<div id="html_d646beacf37742d46d5311f63448bc5a" style="width: 100.0%; height: 100.0%;">Capital de Venezuela</div>`)[0];
                popup_fe13833b4a88d9a4d5afc848a0d1db6b.setContent(html_d646beacf37742d46d5311f63448bc5a);
            
        

        marker_76b8cbc324890493435d5ebdbad292f2.bindPopup(popup_fe13833b4a88d9a4d5afc848a0d1db6b)
        ;

        
    
    
            marker_76b8cbc324890493435d5ebdbad292f2.bindTooltip(
                `<div>
                     Caracas
                 </div>`,
                {
  "sticky": true,
}
            );
    </script>

    <script>
    // --- Datos de ejemplo de capitales: añadir más según necesidad ---
    var CAPITALS = {
        "Venezuela": {lat: 10.4806, lng: -66.9036, name: "Caracas"},
        "United States": {lat: 38.9072, lng: -77.0369, name: "Washington, D.C."},
        "France": {lat: 48.8566, lng: 2.3522, name: "Paris"},
        "Spain": {lat: 40.4168, lng: -3.7038, name: "Madrid"},
        "Brazil": {lat: -15.7939, lng: -47.8828, name: "Brasília"}
        // Agrega aquí más países con la clave que coincida con feature.properties.NAME o name
    };

    // Normalizar nombres para búsqueda más tolerante (sin mayúsculas ni tildes)
    function normalizeName(s) {
        if (!s) return '';
        try {
            // quitar diacríticos y pasar a minúsculas
            return s.normalize('NFD').replace(/\p{Diacritic}/gu, '').toLowerCase();
        } catch (ex) {
            // fallback si normalize con Unicode property no está soportado
            return s.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
        }
    }

    // índice rápido por nombre normalizado
    var CAPITALS_BY_KEY = {};
    Object.keys(CAPITALS).forEach(function(k) {
        CAPITALS_BY_KEY[normalizeName(k)] = CAPITALS[k];
    });

    // mantener múltiples marcadores para permitir ver varias capitales
    var _capitalMarkers = [];

    function createIcon() {
        // intentar usar AwesomeMarkers si está disponible
        try {
            return L.AwesomeMarkers.icon({icon: 'flag', markerColor: 'blue', prefix: 'fa'});
        } catch (ex) {
            return null;
        }
    }

    var _awesomeIcon = createIcon();

    function showCapitalAt(latlng, htmlContent) {
        var markerOptions = {};
        if (_awesomeIcon) markerOptions.icon = _awesomeIcon;
        var m = L.marker([latlng.lat, latlng.lng], markerOptions).addTo(map_8a7b0f5a23f28d54d3c5eaf7cecbeca0);
        m.bindPopup(htmlContent).openPopup();
        _capitalMarkers.push(m);
    }

    // función que maneja el click en un polígono/feature
    function onCountryClick(e) {
        var feature = e.target && e.target.feature ? e.target.feature : null;
        var props = feature ? (feature.properties || {}) : {};
        // intentar varios nombres comunes en propiedades
        var countryName = props.NAME || props.name || props.ADMIN || props.ADMIN_NAME || props.country || props.CNTRY_NAME || props.NAME_LONG || props.SOVEREIGNT || props.formal_en;

        var infoHtml = '';
        var matched = null;
        if (countryName) {
            var key = normalizeName(countryName);
            if (CAPITALS_BY_KEY[key]) matched = CAPITALS_BY_KEY[key];
        }

        if (matched) {
            infoHtml = '<strong>' + (matched.name || 'Capital') + '</strong><br>' + (countryName || '');
            showCapitalAt({lat: matched.lat, lng: matched.lng}, infoHtml);
            // no hacer pan/zoom para respetar la vista actual (el popup abre aunque haya zoom distinto)
        } else {
            // si no hay match, mostrar mensaje y usar la posición del click para el popup
            infoHtml = '<strong>Capital no encontrada</strong><br>' + (countryName || 'País desconocido');
            showCapitalAt(e.latlng, infoHtml);
        }
    }

    // resaltar y resetear estilo (si la capa soporta setStyle)
    function highlightFeature(e) {
        var layer = e.target;
        try { layer.setStyle({weight: 3, color: '#666', fillOpacity: 0.7}); } catch (ex) {}
        if (layer.bringToFront) layer.bringToFront();
    }

    function resetHighlight(e) {
        var layer = e.target;
        try { layer.setStyle({weight: 1, color: '#3388ff', fillOpacity: 0.2}); } catch (ex) {}
    }

    // adjuntar handlers tanto a capas GeoJSON como a features individuales
    function attachGeoJsonHandlers() {
        map_8a7b0f5a23f28d54d3c5eaf7cecbeca0.eachLayer(function(layer) {
            try {
                if (layer instanceof L.GeoJSON) {
                    layer.eachLayer(function(inner) {
                        inner.on({ mouseover: highlightFeature, mouseout: resetHighlight, click: onCountryClick });
                    });
                } else if (layer.feature) {
                    // capas individuales
                    layer.on({ mouseover: highlightFeature, mouseout: resetHighlight, click: onCountryClick });
                }
            } catch (ex) {
                // ignore layers que no expongan la API esperada
            }
        });
    }

    // permitir limpiar marcadores con Ctrl+click en mapa (opcional)
    map_8a7b0f5a23f28d54d3c5eaf7cecbeca0.on('click', function(e) {
        if (e.originalEvent && e.originalEvent.ctrlKey) {
            _capitalMarkers.forEach(function(m){ try{ map_8a7b0f5a23f28d54d3c5eaf7cecbeca0.removeLayer(m);}catch(ex){} });
            _capitalMarkers = [];
        }
    });

    // esperar a que folium/leaflet agregue las capas y luego adjuntar handlers
    window.addEventListener('load', function() { setTimeout(attachGeoJsonHandlers, 500); });

    </script>
</html>